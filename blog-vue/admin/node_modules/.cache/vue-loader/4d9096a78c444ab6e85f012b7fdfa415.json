{"remainingRequest":"C:\\Users\\xiaoxin\\Desktop\\thatblog2\\blog-master\\blog-vue\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\xiaoxin\\Desktop\\thatblog2\\blog-master\\blog-vue\\admin\\src\\views\\role\\Role.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\xiaoxin\\Desktop\\thatblog2\\blog-master\\blog-vue\\admin\\src\\views\\role\\Role.vue","mtime":1633176010974},{"path":"C:\\Users\\xiaoxin\\Desktop\\thatblog2\\blog-master\\blog-vue\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\xiaoxin\\Desktop\\thatblog2\\blog-master\\blog-vue\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\xiaoxin\\Desktop\\thatblog2\\blog-master\\blog-vue\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\xiaoxin\\Desktop\\thatblog2\\blog-master\\blog-vue\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBjcmVhdGVkKCkgewogICAgdGhpcy5saXN0Um9sZXMoKTsKICB9LAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogdHJ1ZSwKICAgICAgaXNEZWxldGU6IGZhbHNlLAogICAgICByb2xlTGlzdDogW10sCiAgICAgIHJvbGVJZExpc3Q6IFtdLAogICAgICBrZXl3b3JkczogbnVsbCwKICAgICAgY3VycmVudDogMSwKICAgICAgc2l6ZTogMTAsCiAgICAgIGNvdW50OiAwLAogICAgICByb2xlTWVudTogZmFsc2UsCiAgICAgIHJvbGVSZXNvdXJjZTogZmFsc2UsCiAgICAgIHJlc291cmNlTGlzdDogW10sCiAgICAgIG1lbnVMaXN0OiBbXSwKICAgICAgcm9sZUZvcm06IHsKICAgICAgICByb2xlTmFtZTogIiIsCiAgICAgICAgcm9sZUxhYmVsOiAiIiwKICAgICAgICByZXNvdXJjZUlkTGlzdDogW10sCiAgICAgICAgbWVudUlkTGlzdDogW10KICAgICAgfQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNlYXJjaFJvbGVzKCkgewogICAgICB0aGlzLmN1cnJlbnQgPSAxOwogICAgICB0aGlzLmxpc3RSb2xlcygpOwogICAgfSwKICAgIHNpemVDaGFuZ2Uoc2l6ZSkgewogICAgICB0aGlzLnNpemUgPSBzaXplOwogICAgICB0aGlzLmxpc3RSb2xlcygpOwogICAgfSwKICAgIGN1cnJlbnRDaGFuZ2UoY3VycmVudCkgewogICAgICB0aGlzLmN1cnJlbnQgPSBjdXJyZW50OwogICAgICB0aGlzLmxpc3RSb2xlcygpOwogICAgfSwKICAgIHNlbGVjdGlvbkNoYW5nZShyb2xlTGlzdCkgewogICAgICB0aGlzLnJvbGVJZExpc3QgPSBbXTsKICAgICAgcm9sZUxpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICB0aGlzLnJvbGVJZExpc3QucHVzaChpdGVtLmlkKTsKICAgICAgfSk7CiAgICB9LAogICAgbGlzdFJvbGVzKCkgewogICAgICB0aGlzLmF4aW9zCiAgICAgICAgLmdldCgiL2FwaS9hZG1pbi9yb2xlcyIsIHsKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBjdXJyZW50OiB0aGlzLmN1cnJlbnQsCiAgICAgICAgICAgIHNpemU6IHRoaXMuc2l6ZSwKICAgICAgICAgICAga2V5d29yZHM6IHRoaXMua2V5d29yZHMKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC50aGVuKCh7IGRhdGEgfSkgPT4gewogICAgICAgICAgICB0aGlzLnJvbGVMaXN0ID0gZGF0YS5kYXRhLnJlY29yZExpc3Q7CiAgICAgICAgICAgIHRoaXMuY291bnQgPSBkYXRhLmRhdGEuY291bnQ7CiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgfSk7CiAgICAgIHRoaXMuYXhpb3MuZ2V0KCIvYXBpL2FkbWluL3JvbGUvcmVzb3VyY2VzIikudGhlbigoeyBkYXRhIH0pID0+IHsKICAgICAgICB0aGlzLnJlc291cmNlTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuYXhpb3MuZ2V0KCIvYXBpL2FkbWluL3JvbGUvbWVudXMiKS50aGVuKCh7IGRhdGEgfSkgPT4gewogICAgICAgIHRoaXMubWVudUxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGRlbGV0ZVJvbGVzKGlkKSB7CiAgICAgIHZhciBwYXJhbSA9IHt9OwogICAgICBpZiAoaWQgPT0gbnVsbCkgewogICAgICAgIHBhcmFtID0geyBkYXRhOiB0aGlzLnJvbGVJZExpc3QgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwYXJhbSA9IHsgZGF0YTogW2lkXSB9OwogICAgICB9CiAgICAgIHRoaXMuYXhpb3MuZGVsZXRlKCIvYXBpL2FkbWluL3JvbGVzIiwgcGFyYW0pLnRoZW4oKHsgZGF0YSB9KSA9PiB7CiAgICAgICAgaWYgKGRhdGEuZmxhZykgewogICAgICAgICAgdGhpcy4kbm90aWZ5LnN1Y2Nlc3MoewogICAgICAgICAgICB0aXRsZTogIuaIkOWKnyIsCiAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEubWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmxpc3RSb2xlcygpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRub3RpZnkuZXJyb3IoewogICAgICAgICAgICB0aXRsZTogIuWksei0pSIsCiAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEubWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHRoaXMuaXNEZWxldGUgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgb3Blbk1lbnVNb2RlbChyb2xlKSB7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uKCkgewogICAgICAgIHRoaXMuJHJlZnMubWVudVRyZWUuc2V0Q2hlY2tlZEtleXMoW10pOwogICAgICB9KTsKICAgICAgdGhpcy4kcmVmcy5yb2xlVGl0bGUuaW5uZXJIVE1MID0gcm9sZSA/ICLkv67mlLnop5LoibIiIDogIuaWsOWinuinkuiJsiI7CiAgICAgIGlmIChyb2xlICE9IG51bGwpIHsKICAgICAgICB0aGlzLnJvbGVGb3JtID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyb2xlKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5yb2xlRm9ybSA9IHsKICAgICAgICAgIHJvbGVOYW1lOiAiIiwKICAgICAgICAgIHJvbGVMYWJlbDogIiIsCiAgICAgICAgICByZXNvdXJjZUlkTGlzdDogW10sCiAgICAgICAgICBtZW51SWRMaXN0OiBbXQogICAgICAgIH07CiAgICAgIH0KICAgICAgdGhpcy5yb2xlTWVudSA9IHRydWU7CiAgICB9LAogICAgb3BlblJlc291cmNlTW9kZWwocm9sZSkgewogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLiRyZWZzLnJlc291cmNlVHJlZS5zZXRDaGVja2VkS2V5cyhbXSk7CiAgICAgIH0pOwogICAgICB0aGlzLnJvbGVGb3JtID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyb2xlKSk7CiAgICAgIHRoaXMucm9sZVJlc291cmNlID0gdHJ1ZTsKICAgIH0sCiAgICBzYXZlT3JVcGRhdGVSb2xlUmVzb3VyY2UoKSB7CiAgICAgIHRoaXMucm9sZUZvcm0ubWVudUlkTGlzdCA9IG51bGw7CiAgICAgIHRoaXMucm9sZUZvcm0ucmVzb3VyY2VJZExpc3QgPSB0aGlzLiRyZWZzLnJlc291cmNlVHJlZS5nZXRDaGVja2VkS2V5cygpOwogICAgICB0aGlzLmF4aW9zLnBvc3QoIi9hcGkvYWRtaW4vcm9sZSIsIHRoaXMucm9sZUZvcm0pLnRoZW4oKHsgZGF0YSB9KSA9PiB7CiAgICAgICAgaWYgKGRhdGEuZmxhZykgewogICAgICAgICAgdGhpcy4kbm90aWZ5LnN1Y2Nlc3MoewogICAgICAgICAgICB0aXRsZTogIuaIkOWKnyIsCiAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEubWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmxpc3RSb2xlcygpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRub3RpZnkuZXJyb3IoewogICAgICAgICAgICB0aXRsZTogIuWksei0pSIsCiAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEubWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHRoaXMucm9sZVJlc291cmNlID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIHNhdmVPclVwZGF0ZVJvbGVNZW51KCkgewogICAgICBpZiAodGhpcy5yb2xlRm9ybS5yb2xlTmFtZS50cmltKCkgPT0gIiIpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLop5LoibLlkI3kuI3og73kuLrnqboiKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKHRoaXMucm9sZUZvcm0ucm9sZUxhYmVsLnRyaW0oKSA9PSAiIikgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuadg+mZkOagh+etvuS4jeiDveS4uuepuiIpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB0aGlzLnJvbGVGb3JtLnJlc291cmNlSWRMaXN0ID0gbnVsbDsKICAgICAgdGhpcy5yb2xlRm9ybS5tZW51SWRMaXN0ID0gdGhpcy4kcmVmcy5tZW51VHJlZQogICAgICAgIC5nZXRDaGVja2VkS2V5cygpCiAgICAgICAgLmNvbmNhdCh0aGlzLiRyZWZzLm1lbnVUcmVlLmdldEhhbGZDaGVja2VkS2V5cygpKTsKICAgICAgdGhpcy5heGlvcy5wb3N0KCIvYXBpL2FkbWluL3JvbGUiLCB0aGlzLnJvbGVGb3JtKS50aGVuKCh7IGRhdGEgfSkgPT4gewogICAgICAgIGlmIChkYXRhLmZsYWcpIHsKICAgICAgICAgIHRoaXMuJG5vdGlmeS5zdWNjZXNzKHsKICAgICAgICAgICAgdGl0bGU6ICLmiJDlip8iLAogICAgICAgICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5saXN0Um9sZXMoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbm90aWZ5LmVycm9yKHsKICAgICAgICAgICAgdGl0bGU6ICLlpLHotKUiLAogICAgICAgICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICB0aGlzLnJvbGVNZW51ID0gZmFsc2U7CiAgICAgIH0pOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["Role.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Role.vue","sourceRoot":"src/views/role","sourcesContent":["<template>\n  <el-card class=\"main-card\">\n    <div class=\"title\">{{ this.$route.name }}</div>\n    <!-- 表格操作 -->\n    <div class=\"operation-container\">\n      <el-button\n        type=\"primary\"\n        size=\"small\"\n        icon=\"el-icon-plus\"\n        @click=\"openMenuModel(null)\"\n      >\n        新增\n      </el-button>\n      <el-button\n        type=\"danger\"\n        size=\"small\"\n        icon=\"el-icon-delete\"\n        :disabled=\"this.roleIdList.length == 0\"\n        @click=\"isDelete = true\"\n      >\n        批量删除\n      </el-button>\n      <!-- 条件筛选 -->\n      <div style=\"margin-left:auto\">\n        <el-input\n          v-model=\"keywords\"\n          prefix-icon=\"el-icon-search\"\n          size=\"small\"\n          placeholder=\"请输入角色名\"\n          style=\"width:200px\"\n          @keyup.enter.native=\"searchRoles\"\n        />\n        <el-button\n          type=\"primary\"\n          size=\"small\"\n          icon=\"el-icon-search\"\n          style=\"margin-left:1rem\"\n          @click=\"searchRoles\"\n        >\n          搜索\n        </el-button>\n      </div>\n    </div>\n    <!-- 表格展示 -->\n    <el-table\n      border\n      :data=\"roleList\"\n      @selection-change=\"selectionChange\"\n      v-loading=\"loading\"\n    >\n      <!-- 表格列 -->\n      <el-table-column type=\"selection\" width=\"55\" />\n      <el-table-column prop=\"roleName\" label=\"角色名\" align=\"center\" />\n      <el-table-column prop=\"roleLabel\" label=\"权限标签\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-tag>\n            {{ scope.row.roleLabel }}\n          </el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"isDisable\" label=\"禁用\" align=\"center\" width=\"100\">\n        <template slot-scope=\"scope\">\n          <el-switch\n            v-model=\"scope.row.isDisable\"\n            active-color=\"#13ce66\"\n            inactive-color=\"#F4F4F5\"\n            :active-value=\"1\"\n            :inactive-value=\"0\"\n            @change=\"changeDisable(scope.row)\"\n          />\n        </template>\n      </el-table-column>\n      <el-table-column\n        prop=\"createTime\"\n        label=\"创建时间\"\n        width=\"150\"\n        align=\"center\"\n      >\n        <template slot-scope=\"scope\">\n          <i class=\"el-icon-time\" style=\"margin-right:5px\" />\n          {{ scope.row.createTime | date }}\n        </template>\n      </el-table-column>\n      <!-- 列操作 -->\n      <el-table-column label=\"操作\" align=\"center\" width=\"220\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"text\" size=\"mini\" @click=\"openMenuModel(scope.row)\">\n            <i class=\"el-icon-edit\" /> 菜单权限\n          </el-button>\n          <el-button\n            type=\"text\"\n            size=\"mini\"\n            @click=\"openResourceModel(scope.row)\"\n          >\n            <i class=\"el-icon-folder-checked\" /> 资源权限\n          </el-button>\n          <el-popconfirm\n            title=\"确定删除吗？\"\n            style=\"margin-left:10px\"\n            @confirm=\"deleteRoles(scope.row.id)\"\n          >\n            <el-button size=\"mini\" type=\"text\" slot=\"reference\">\n              <i class=\"el-icon-delete\" /> 删除\n            </el-button>\n          </el-popconfirm>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!-- 分页 -->\n    <el-pagination\n      class=\"pagination-container\"\n      background\n      @size-change=\"sizeChange\"\n      @current-change=\"currentChange\"\n      :current-page=\"current\"\n      :page-size=\"size\"\n      :total=\"count\"\n      :page-sizes=\"[10, 20]\"\n      layout=\"total, sizes, prev, pager, next, jumper\"\n    />\n    <!-- 菜单对话框 -->\n    <el-dialog :visible.sync=\"roleMenu\" width=\"30%\">\n      <div class=\"dialog-title-container\" slot=\"title\" ref=\"roleTitle\" />\n      <el-form label-width=\"80px\" size=\"medium\" :model=\"roleForm\">\n        <el-form-item label=\"角色名\">\n          <el-input v-model=\"roleForm.roleName\" style=\"width:250px\" />\n        </el-form-item>\n        <el-form-item label=\"权限标签\">\n          <el-input v-model=\"roleForm.roleLabel\" style=\"width:250px\" />\n        </el-form-item>\n        <el-form-item label=\"菜单权限\">\n          <el-tree\n            :data=\"menuList\"\n            :default-checked-keys=\"roleForm.menuIdList\"\n            check-strictly\n            show-checkbox\n            node-key=\"id\"\n            ref=\"menuTree\"\n          />\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\">\n        <el-button @click=\"roleMenu = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"saveOrUpdateRoleMenu\">\n          确 定\n        </el-button>\n      </div>\n    </el-dialog>\n    <!-- 资源对话框 -->\n    <el-dialog :visible.sync=\"roleResource\" width=\"30%\" top=\"9vh\">\n      <div class=\"dialog-title-container\" slot=\"title\">修改资源权限</div>\n      <el-form label-width=\"80px\" size=\"medium\" :model=\"roleForm\">\n        <el-form-item label=\"角色名\">\n          <el-input v-model=\"roleForm.roleName\" style=\"width:250px\" />\n        </el-form-item>\n        <el-form-item label=\"权限标签\">\n          <el-input v-model=\"roleForm.roleLabel\" style=\"width:250px\" />\n        </el-form-item>\n        <el-form-item label=\"资源权限\">\n          <el-tree\n            :data=\"resourceList\"\n            :default-checked-keys=\"roleForm.resourceIdList\"\n            show-checkbox\n            node-key=\"id\"\n            ref=\"resourceTree\"\n          />\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\">\n        <el-button @click=\"roleResource = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"saveOrUpdateRoleResource\">\n          确 定\n        </el-button>\n      </div>\n    </el-dialog>\n    <!-- 批量删除对话框 -->\n    <el-dialog :visible.sync=\"isDelete\" width=\"30%\">\n      <div class=\"dialog-title-container\" slot=\"title\">\n        <i class=\"el-icon-warning\" style=\"color:#ff9900\" />提示\n      </div>\n      <div style=\"font-size:1rem\">是否删除选中项？</div>\n      <div slot=\"footer\">\n        <el-button @click=\"isDelete = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"deleteRoles(null)\">\n          确 定\n        </el-button>\n      </div>\n    </el-dialog>\n  </el-card>\n</template>\n\n<script>\nexport default {\n  created() {\n    this.listRoles();\n  },\n  data: function() {\n    return {\n      loading: true,\n      isDelete: false,\n      roleList: [],\n      roleIdList: [],\n      keywords: null,\n      current: 1,\n      size: 10,\n      count: 0,\n      roleMenu: false,\n      roleResource: false,\n      resourceList: [],\n      menuList: [],\n      roleForm: {\n        roleName: \"\",\n        roleLabel: \"\",\n        resourceIdList: [],\n        menuIdList: []\n      }\n    };\n  },\n  methods: {\n    searchRoles() {\n      this.current = 1;\n      this.listRoles();\n    },\n    sizeChange(size) {\n      this.size = size;\n      this.listRoles();\n    },\n    currentChange(current) {\n      this.current = current;\n      this.listRoles();\n    },\n    selectionChange(roleList) {\n      this.roleIdList = [];\n      roleList.forEach(item => {\n        this.roleIdList.push(item.id);\n      });\n    },\n    listRoles() {\n      this.axios\n        .get(\"/api/admin/roles\", {\n          params: {\n            current: this.current,\n            size: this.size,\n            keywords: this.keywords\n          }\n        })\n        .then(({ data }) => {\n            this.roleList = data.data.recordList;\n            this.count = data.data.count;\n            this.loading = false;\n          });\n      this.axios.get(\"/api/admin/role/resources\").then(({ data }) => {\n        this.resourceList = data.data;\n      });\n      this.axios.get(\"/api/admin/role/menus\").then(({ data }) => {\n        this.menuList = data.data;\n      });\n    },\n    deleteRoles(id) {\n      var param = {};\n      if (id == null) {\n        param = { data: this.roleIdList };\n      } else {\n        param = { data: [id] };\n      }\n      this.axios.delete(\"/api/admin/roles\", param).then(({ data }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: \"成功\",\n            message: data.message\n          });\n          this.listRoles();\n        } else {\n          this.$notify.error({\n            title: \"失败\",\n            message: data.message\n          });\n        }\n        this.isDelete = false;\n      });\n    },\n    openMenuModel(role) {\n      this.$nextTick(function() {\n        this.$refs.menuTree.setCheckedKeys([]);\n      });\n      this.$refs.roleTitle.innerHTML = role ? \"修改角色\" : \"新增角色\";\n      if (role != null) {\n        this.roleForm = JSON.parse(JSON.stringify(role));\n      } else {\n        this.roleForm = {\n          roleName: \"\",\n          roleLabel: \"\",\n          resourceIdList: [],\n          menuIdList: []\n        };\n      }\n      this.roleMenu = true;\n    },\n    openResourceModel(role) {\n      this.$nextTick(function() {\n        this.$refs.resourceTree.setCheckedKeys([]);\n      });\n      this.roleForm = JSON.parse(JSON.stringify(role));\n      this.roleResource = true;\n    },\n    saveOrUpdateRoleResource() {\n      this.roleForm.menuIdList = null;\n      this.roleForm.resourceIdList = this.$refs.resourceTree.getCheckedKeys();\n      this.axios.post(\"/api/admin/role\", this.roleForm).then(({ data }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: \"成功\",\n            message: data.message\n          });\n          this.listRoles();\n        } else {\n          this.$notify.error({\n            title: \"失败\",\n            message: data.message\n          });\n        }\n        this.roleResource = false;\n      });\n    },\n    saveOrUpdateRoleMenu() {\n      if (this.roleForm.roleName.trim() == \"\") {\n        this.$message.error(\"角色名不能为空\");\n        return false;\n      }\n      if (this.roleForm.roleLabel.trim() == \"\") {\n        this.$message.error(\"权限标签不能为空\");\n        return false;\n      }\n      this.roleForm.resourceIdList = null;\n      this.roleForm.menuIdList = this.$refs.menuTree\n        .getCheckedKeys()\n        .concat(this.$refs.menuTree.getHalfCheckedKeys());\n      this.axios.post(\"/api/admin/role\", this.roleForm).then(({ data }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: \"成功\",\n            message: data.message\n          });\n          this.listRoles();\n        } else {\n          this.$notify.error({\n            title: \"失败\",\n            message: data.message\n          });\n        }\n        this.roleMenu = false;\n      });\n    }\n  }\n};\n</script>\n"]}]}